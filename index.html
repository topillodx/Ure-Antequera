<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Sorteo URE Antequera</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
    margin: 0;
    font-family: "Segoe UI", Arial, sans-serif;
    background:  #00ff00;
}

header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    background: linear-gradient(90deg,#b71c1c,#e53935);
    color: white;
    padding: 12px 18px;
}

.header-left {
    display: flex;
    align-items: center;
    gap: 15px;
}

.header-left img {
    height: 60px;
}

.admin-header {
    background: rgba(255,255,255,0.15);
    border: 1px solid white;
    color: white;
    font-size: 18px;
    padding: 8px 12px;
    border-radius: 8px;
    cursor: pointer;
    margin-left: 5px;
}

.contenido {
    max-width: 900px;
    margin: auto;
    padding: 20px;
}

.card {
    background: white;
    padding: 18px;
    border-radius: 12px;
    margin-top: 20px;
    box-shadow: 0 6px 18px rgba(0,0,0,0.12);
}

.sorteo-img img {
    width: 100%;
    height: auto;
    object-fit: contain;
    border-radius: 12px;
    background: black;
}

.pagos {
    display: grid;
    grid-template-columns: repeat(auto-fit,minmax(140px,1fr));
    gap: 12px;
}

.pagos button {
    padding: 14px;
    font-size: 16px;
    font-weight: bold;
    border-radius: 10px;
    border: none;
    color: white;
    cursor: pointer;
}

.bizum { background:#5f2eea; }
.transferencia { background:#00897b; }
.paypal { background:#003087; }

.numeros {
    display: grid;
    grid-template-columns: repeat(5,1fr);
    gap: 10px;
    margin-top: 15px;
}

@media (min-width:600px){
    .numeros { grid-template-columns: repeat(10,1fr); }
}

.numero {
    background: #ccc;
    padding: 12px;
    border-radius: 8px;
    text-align: center;
    cursor: pointer;
    font-weight: bold;
    transition: transform .15s;
}

.numero:hover {
    transform: scale(1.05);
}

.apartado { background:#ffc107; }
.pagado { background:#4caf50; color:white; }

.nombre {
    font-size: 12px;
    margin-top: 4px;
    opacity: .85;
}
</style>
</head>

<body>

<header>
    <div class="header-left">
        <img src="Logo.png">
        <h2>EA7URT<br>URE Antequera (Union de Radioaficionados del Torcal)</h2>
    </div>
    <div>
        <button class="admin-header" onclick="adminPanel()">‚öôÔ∏è</button>
        <button class="admin-header" onclick="verListado()">üìã</button>
    </div>
</header>

<div class="contenido">

<div class="card sorteo-img">
    <img src="Sorteo.jpeg">
</div>

<div class="card" id="infoSorteo"></div>

<div class="card">
    <h3>üí≥ Ingreso Donativo</h3>
    <div class="pagos">
        <button class="bizum" onclick="alert('Bizum: ' + bizum)">BIZUM</button>
        <button class="transferencia" onclick="alert('IBAN: ' + iban)">TRANSFERENCIA</button>
        <button class="paypal" onclick="alert('PayPal: ' + paypal)">PAYPAL</button>
    </div>
</div>

<div class="card">
    <h3>üéüÔ∏è N√∫meros</h3>
    <p>‚¨ú Libre &nbsp; üü® Apartado &nbsp; üü© Pagado</p>
    <div class="numeros" id="numeros"></div>
</div>

</div>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<script>
const ADMIN_PASSWORD = "EA7URT2030@";
const TRES_DIAS = 3 * 24 * 60 * 60 * 1000;

firebase.initializeApp({
  apiKey: "AIzaSyB3fE0DmiE7AcbcCq11P3vDB2Y4DgTbTbM",
  authDomain: "sorteo-ure-antequera.firebaseapp.com",
  databaseURL: "https://sorteo-ure-antequera-default-rtdb.europe-west1.firebasedatabase.app",
  projectId: "sorteo-ure-antequera",
  storageBucket: "sorteo-ure-antequera.firebasestorage.app",
  messagingSenderId: "108791552010",
  appId: "1:108791552010:web:80db910fd30c67cfac27f3"
});

const db = firebase.database();

let data = {};
let infoTexto = `<b>üéÅ Sorteo:</b> Yaesu FTM-510<br>
<b>üìÖ Fecha:</b> __ / __ / ____<br>
<b>üí∞ Donativo:</b> 10‚Ç¨<br>
<b>üìå Aviso:</b> Los n√∫meros se guardar√°n 3 d√≠as.<br>
<b>üìå Normas:</b> El sorteo se realizar√° cuando est√©n todos los n√∫meros ocupados`;

let bizum = "600000000";
let iban = "ES00 0000 0000 0000";
let paypal = "correo@paypal.com";

function guardarTodo(){
    db.ref().set({ rifa:data, infoTexto, bizum, iban, paypal });
}

function liberarCaducados(){
    const ahora = Date.now();
    let cambios = false;

    for(const n in data){
        if(data[n].estado==="apartado" && data[n].fecha){
            if(ahora - data[n].fecha >= TRES_DIAS){
                delete data[n];
                cambios = true;
            }
        }
    }
    if(cambios) guardarTodo();
}

function crearNumeros(){
    document.getElementById("infoSorteo").innerHTML = infoTexto;
    const cont = document.getElementById("numeros");
    cont.innerHTML = "";

    for(let i=0;i<100;i++){
        const num = i.toString().padStart(2,"0");
        const d = document.createElement("div");
        d.className = "numero";

        if(data[num]){
            d.classList.add(data[num].estado);
            d.innerHTML = num + "<div class='nombre'>" + data[num].nombre + "</div>";
        } else d.textContent = num;

        d.onclick = ()=>clickNumero(num);
        cont.appendChild(d);
    }
}

function clickNumero(num){
    if(!data[num]){
        const nombre = prompt("Nombre / Indicativo:");
        if(!nombre) return;
        data[num]={ nombre, estado:"apartado", fecha:Date.now() };
        guardarTodo();
        return;
    }

    alert("N√∫mero ocupado por " + data[num].nombre);
    const pass = prompt("Contrase√±a administrador:");
    if(pass!==ADMIN_PASSWORD) return;

    const a = prompt("1 = Confirmar pago\n2 = Liberar n√∫mero");
    if(a==="1") data[num].estado="pagado";
    if(a==="2") delete data[num];
    guardarTodo();
}

function adminPanel(){
    const pass = prompt("Contrase√±a administrador:");
    if(pass!==ADMIN_PASSWORD) return;

    infoTexto = prompt("Texto del sorteo:", infoTexto) || infoTexto;
    bizum = prompt("Bizum:", bizum) || bizum;
    iban = prompt("IBAN:", iban) || iban;
    paypal = prompt("PayPal:", paypal) || paypal;
    guardarTodo();
}

function verListado(){
    const pass = prompt("Contrase√±a administrador:");
    if(pass!==ADMIN_PASSWORD) return;

    let t="LISTADO PARTICIPANTES\n\nN√∫mero | Nombre | Estado\n";
    Object.keys(data).sort().forEach(n=>{
        t+=`${n} | ${data[n].nombre} | ${data[n].estado}\n`;
    });
    alert(t);
}

db.ref().on("value", snap=>{
    const v=snap.val()||{};
    data=v.rifa||{};
    infoTexto=v.infoTexto||infoTexto;
    bizum=v.bizum||bizum;
    iban=v.iban||iban;
    paypal=v.paypal||paypal;
    liberarCaducados();
    crearNumeros();
});
</script>

</body>
</html>







